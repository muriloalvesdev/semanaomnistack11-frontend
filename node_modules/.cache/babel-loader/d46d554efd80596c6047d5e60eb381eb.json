{"ast":null,"code":"import _regeneratorRuntime from\"/Users/muriloalves/Documents/Murilo/OmniStack/github/semanaomnistack11-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/muriloalves/Documents/Murilo/OmniStack/github/semanaomnistack11-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/muriloalves/Documents/Murilo/OmniStack/github/semanaomnistack11-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link,useHistory}from'react-router-dom';import{FiPower,FiTrash2}from'react-icons/fi';import logImg from\"../../assets/logo.svg\";import api from'../../services/api';import'./styles.css';export default function Profile(){var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),incidents=_useState2[0],setIncidents=_useState2[1];var ongName=localStorage.getItem('ongName');var ongId=localStorage.getItem('ongId');useEffect(function(){api.get('profile',{headers:{Authorization:ongId}}).then(function(response){setIncidents(response.data.incidents);});},[ongId]);function handleDeleteIncident(_x){return _handleDeleteIncident.apply(this,arguments);}function _handleDeleteIncident(){_handleDeleteIncident=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api.delete(\"incidents/\".concat(id),{headers:{Authorization:ongId}});case 3:setIncidents(incidents.filter(function(incident){return incident.id!==id;}));_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);alert('Erro ao tentar deletar caso, tente novamente.');case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return _handleDeleteIncident.apply(this,arguments);}function handleLogout(){localStorage.clear();history.push('/');}return/*#__PURE__*/React.createElement(\"div\",{className:\"profile-container\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"img\",{src:logImg,alt:\"Be The Hero\"}),/*#__PURE__*/React.createElement(\"span\",null,\"Bem vinda, \",ongName,\"!\"),/*#__PURE__*/React.createElement(Link,{className:\"button\",to:\"/incidents/new\"},\"Cadastrar novo caso\"),/*#__PURE__*/React.createElement(\"button\",{onClick:handleLogout,type:\"button\"},/*#__PURE__*/React.createElement(FiPower,{size:18,color:\"#E02041\"}))),/*#__PURE__*/React.createElement(\"h1\",null,\"Casos cadastrados\"),/*#__PURE__*/React.createElement(\"ul\",null,incidents.map(function(incident){return/*#__PURE__*/React.createElement(\"li\",{key:incident.id},/*#__PURE__*/React.createElement(\"strong\",null,\"CASO:\"),/*#__PURE__*/React.createElement(\"p\",null,incident.title),/*#__PURE__*/React.createElement(\"strong\",null,\"DESCRI\\xC7\\xC3O:\"),/*#__PURE__*/React.createElement(\"p\",null,incident.description),/*#__PURE__*/React.createElement(\"strong\",null,\"VALOR: \"),/*#__PURE__*/React.createElement(\"p\",null,Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'}).format(incident.value)),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return handleDeleteIncident(incident.id);},type:\"button\"},/*#__PURE__*/React.createElement(FiTrash2,{size:20,color:\"#a8a8b3\"})));})));}","map":{"version":3,"sources":["/Users/muriloalves/Documents/Murilo/OmniStack/github/semanaomnistack11-frontend/src/pages/Profile/index.js"],"names":["React","useState","useEffect","Link","useHistory","FiPower","FiTrash2","api","Profile","history","incidents","setIncidents","ongName","localStorage","getItem","ongId","get","headers","Authorization","then","response","data","handleDeleteIncident","id","delete","filter","incident","alert","handleLogout","clear","push","logImg","map","title","description","Intl","NumberFormat","style","currency","format","value"],"mappings":"+kBAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,CAAyBC,SAAzB,KAAyC,OAAzC,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,OAAT,CAAkBC,QAAlB,KAAkC,gBAAlC,C,0CAGA,MAAOC,CAAAA,GAAP,KAAgB,oBAAhB,CAEA,MAAO,cAAP,CAEA,cAAe,SAASC,CAAAA,OAAT,EAAmB,CAC9B,GAAMC,CAAAA,OAAO,CAAGL,UAAU,EAA1B,CAD8B,cAGIH,QAAQ,CAAC,EAAD,CAHZ,wCAGvBS,SAHuB,eAGZC,YAHY,eAK9B,GAAMC,CAAAA,OAAO,CAAGC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAhB,CACA,GAAMC,CAAAA,KAAK,CAAGF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd,CACAZ,SAAS,CAAC,UAAM,CACZK,GAAG,CAACS,GAAJ,CAAQ,SAAR,CAAmB,CACfC,OAAO,CAAE,CACLC,aAAa,CAAEH,KADV,CADM,CAAnB,EAIGI,IAJH,CAIQ,SAAAC,QAAQ,CAAI,CAChBT,YAAY,CAACS,QAAQ,CAACC,IAAT,CAAcX,SAAf,CAAZ,CACH,CAND,EAOH,CARQ,CAQN,CAACK,KAAD,CARM,CAAT,CAP8B,QAiBhBO,CAAAA,oBAjBgB,wKAiB/B,iBAAoCC,EAApC,wJAEehB,CAAAA,GAAG,CAACiB,MAAJ,qBAAwBD,EAAxB,EAA8B,CAChCN,OAAO,CAAE,CACLC,aAAa,CAAEH,KADV,CADuB,CAA9B,CAFf,QAQSJ,YAAY,CAACD,SAAS,CAACe,MAAV,CAAiB,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACH,EAAT,GAAgBA,EAApB,EAAzB,CAAD,CAAZ,CART,8EAUSI,KAAK,CAAC,+CAAD,CAAL,CAVT,mEAjB+B,uDA+B9B,QAASC,CAAAA,YAAT,EAAuB,CACnBf,YAAY,CAACgB,KAAb,GACApB,OAAO,CAACqB,IAAR,CAAa,GAAb,EACH,CAED,mBACI,2BAAK,SAAS,CAAC,mBAAf,eACI,+CACI,2BAAK,GAAG,CAAEC,MAAV,CAAkB,GAAG,CAAC,aAAtB,EADJ,cAEI,8CAAkBnB,OAAlB,KAFJ,cAGI,oBAAC,IAAD,EAAM,SAAS,CAAC,QAAhB,CAAyB,EAAE,CAAC,gBAA5B,wBAHJ,cAII,8BAAQ,OAAO,CAAEgB,YAAjB,CAA+B,IAAI,CAAC,QAApC,eACI,oBAAC,OAAD,EAAS,IAAI,CAAE,EAAf,CAAmB,KAAK,CAAC,SAAzB,EADJ,CAJJ,CADJ,cASI,kDATJ,cAWI,8BACKlB,SAAS,CAACsB,GAAV,CAAc,SAAAN,QAAQ,qBACnB,0BAAI,GAAG,CAAIA,QAAQ,CAACH,EAApB,eACI,0CADJ,cAEI,6BAAIG,QAAQ,CAACO,KAAb,CAFJ,cAGI,qDAHJ,cAII,6BAAIP,QAAQ,CAACQ,WAAb,CAJJ,cAKI,4CALJ,cAMI,6BAAIC,IAAI,CAACC,YAAL,CACC,OADD,CACU,CAACC,KAAK,CAAE,UAAR,CAAoBC,QAAQ,CAAE,KAA9B,CADV,EAECC,MAFD,CAEQb,QAAQ,CAACc,KAFjB,CAAJ,CANJ,cAUI,8BAAQ,OAAO,CAAE,yBAAMlB,CAAAA,oBAAoB,CAACI,QAAQ,CAACH,EAAV,CAA1B,EAAjB,CAA0D,IAAI,CAAC,QAA/D,eACI,oBAAC,QAAD,EAAU,IAAI,CAAE,EAAhB,CAAoB,KAAK,CAAC,SAA1B,EADJ,CAVJ,CADmB,EAAtB,CADL,CAXJ,CADJ,CAgCH","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { FiPower, FiTrash2 } from 'react-icons/fi';\n\nimport logImg from  '../../assets/logo.svg';\nimport api from '../../services/api';\n\nimport './styles.css';\n\nexport default function Profile() {\n    const history = useHistory();\n\n    const [incidents, setIncidents] = useState([]);\n\n    const ongName = localStorage.getItem('ongName');\n    const ongId = localStorage.getItem('ongId');\n    useEffect(() => {\n        api.get('profile', {\n            headers: {\n                Authorization: ongId,\n            }\n        }).then(response => {\n            setIncidents(response.data.incidents);\n        })\n    }, [ongId]);\n\n   async function handleDeleteIncident(id){\n        try{\n            await api.delete(`incidents/${id}`, {\n                headers: {\n                    Authorization: ongId,\n                }\n            });\n            \n            setIncidents(incidents.filter(incident => incident.id !== id));\n        }catch(ex){\n            alert('Erro ao tentar deletar caso, tente novamente.')\n        }\n    }\n\n    function handleLogout(){\n        localStorage.clear();\n        history.push('/');\n    }\n\n    return (\n        <div className=\"profile-container\">\n            <header>\n                <img src={logImg} alt=\"Be The Hero\"/>\n                <span>Bem vinda, {ongName}!</span>\n                <Link className=\"button\" to=\"/incidents/new\" >Cadastrar novo caso</Link>\n                <button onClick={handleLogout} type=\"button\">\n                    <FiPower size={18} color=\"#E02041\" />\n                </button>\n            </header>\n            <h1>Casos cadastrados</h1>\n            \n            <ul>\n                {incidents.map(incident => (\n                    <li key = {incident.id}>\n                        <strong>CASO:</strong>\n                        <p>{incident.title}</p>\n                        <strong>DESCRIÇÃO:</strong>\n                        <p>{incident.description}</p>\n                        <strong>VALOR: </strong>\n                        <p>{Intl.NumberFormat\n                            ('pt-BR', {style: 'currency', currency: 'BRL'})\n                            .format(incident.value)}</p>\n\n                        <button onClick={() => handleDeleteIncident(incident.id)} type=\"button\">\n                            <FiTrash2 size={20} color=\"#a8a8b3\" />\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}